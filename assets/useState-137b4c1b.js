import{a as g,b as s,__tla as V}from"./federation-shared-c16daac1.js";import{b as Y,e as $}from"./constants-278efb7a.js";let C,R,I,j,x,p,b,B,y,f,P,A,F,T,L,N,O,q=Promise.all([(()=>{try{return V}catch{}})()]).then(async()=>{const w=await g("vue"),D="nextTick";N=function(e){return{title:"",version:0,libs:[],originSchema:"",prodSchema:"",curElementId:null,boundingRect:null,editingId:null,ctrlKey:!1,pauseKeyEvent:!1,showLayer:!0,showSetting:!0,parentMap:new Map,elementIdMap:new Map,expandedKeyMap:new Map,curDragCode:null,curDragId:null,isDragging:!1,isBefore:!1,isSink:!1,dragPosition:null,selectElementIds:new Set,rollbackStack:[],elements:[],style:{},dynamicClass:"",dynamicStyle:"",globalStyle:"",variables:[],isDesginer:e,postMessage:()=>null}};const M=[];let E=!1,d,k,v,o,S;p=(e,t)=>{E||(M.unshift(t),s(w,D)(()=>{if(!M.length)return;const n=M.slice();M.length=0,e.rollbackStack.push(()=>{n.forEach(l=>l())}),e.rollbackStack.length>100&&e.rollbackStack.shift()}))},L=e=>{var n;const t=e.rollbackStack.pop();t&&(E=!0,t(),s(w,D)(()=>E=!1),e.isDesginer&&((n=e.postMessage)==null||n.call(e,{type:"popRollback"})))},T=()=>{},C=(e,t)=>{e.ctrlKey&&t.metaCode!=="slot"&&e.selectElementIds.add(t.uid)},d=await g("vue"),k=await g("@rdx/shared"),v="treeForEach",o="nextTick",S="toRaw",b=e=>I(e,e.curElementId),I=function(e,t){return e.elementIdMap.get(t)??null},f=function(e,t){return e.parentMap.get(t.uid)??null},y=function(e,t){e.elementIdMap.set(t.uid,t),s(k,v)(t.children,(n,l,u,r)=>{e.parentMap.set(n.uid,r??t),e.elementIdMap.set(n.uid,n),t.uid!==0&&e.expandedKeyMap.set(t.uid,!0)}),t.uid!==0&&e.expandedKeyMap.set(t.uid,!0)},R=function(e,t,n){var u,r,i;const l=f(e,t);if(t=I(e,t.uid)??t,l){const a=(u=l.children)==null?void 0:u.findIndex(m=>m.uid===t.uid);(r=l.children)==null||r.splice(a,1),e.parentMap.delete(t.uid),s(d,o)(()=>{p(e,()=>{var m;(m=l.children)==null||m.splice(a,0,t),e.parentMap.set(t.uid,l),e.elementIdMap.set(t.uid,t)})})}n.children||(n.children=[]),(i=n.children)==null||i.push(t),e.parentMap.set(t.uid,n),(l==null?void 0:l.uid)!==n.uid&&y(e,t),s(d,o)(()=>{p(e,()=>{var a;e.curElementId===t.uid&&(e.curElementId=null),(a=n.children)==null||a.pop(),e.parentMap.delete(t.uid),e.elementIdMap.delete(t.uid)})}),e.isDesginer&&e.postMessage({type:"appendChild",data:{parentId:n.uid,element:s(d,S)(t)}})},j=function(e,t,n,l=!0){var i,a,m;if(t.uid===n.uid)return;t=I(e,t.uid)??t;const u=f(e,t);if(u){const h=(i=u.children)==null?void 0:i.findIndex(c=>c.uid===t.uid);(a=u.children)==null||a.splice(h,1),e.parentMap.delete(t.uid),s(d,o)(()=>{p(e,()=>{var c;(c=u.children)==null||c.splice(h,0,t),e.parentMap.set(t.uid,u),e.elementIdMap.set(t.uid,t)})})}const r=f(e,n);if(r.children||(r.children=[]),n){const h=r.children.findIndex(c=>c.uid===n.uid);h===-1?(r.children.push(t),s(d,o)(()=>{p(e,()=>{var c;e.curElementId===t.uid&&(e.curElementId=null),(c=r.children)==null||c.pop()})})):l?(r.children.splice(h,0,t),s(d,o)(()=>{p(e,()=>{var c;e.curElementId===t.uid&&(e.curElementId=null),(c=r.children)==null||c.splice(h,1)})})):(r.children.splice(h+1,0,t),s(d,o)(()=>{p(e,()=>{var c;e.curElementId===t.uid&&(e.curElementId=null),(c=r.children)==null||c.splice(h+1,1)})}))}else r.children.push(t),s(d,o)(()=>{p(e,()=>{var h;e.curElementId===t.uid&&(e.curElementId=null),(h=r.children)==null||h.pop()})});e.parentMap.set(t.uid,r),(u==null?void 0:u.uid)!==r.uid&&y(e,t),s(d,o)(()=>{p(e,()=>{e.parentMap.delete(t.uid),e.elementIdMap.delete(t.uid)})}),e.isDesginer&&((m=e.postMessage)==null||m.call(e,{type:l?"insertBefore":"insertAfter",data:{childId:n.uid,element:s(d,S)(t)}}))},x=function(e,t){var u,r,i;if(!t)return;t=I(e,t.uid)??t;const n=f(e,t),l=(u=n.children)==null?void 0:u.findIndex(a=>a.uid===t.uid);if(l!==-1){e.curElementId===t.uid&&(e.curElementId=null),(r=n.children)==null||r.splice(l,1),e.parentMap.delete(t.uid),e.elementIdMap.delete(t.uid),e.expandedKeyMap.delete(t.uid),e.isDesginer&&(s(k,v)(t.children,a=>{x(e,a)}),(i=e.postMessage)==null||i.call(e,{type:"removeChild",data:t.uid})),s(d,o)(()=>{p(e,()=>{var a;(a=n.children)==null||a.splice(l,0,t),e.parentMap.set(t.uid,n),e.elementIdMap.set(t.uid,t)})});for(let a=e.variables.length-1;a>=0;a-=1){if(e.variables[a].elementId!==t.uid)continue;const m=e.variables[a];e.variables.splice(a,1),s(d,o)(()=>{p(e,()=>{e.variables.push(m)})})}}},F=function(e,t,n,l,u=!1){const r=b(e).uid,i=e.variables.find(a=>a.elementId===r&&a.code===t);i?(i.name=n,i.remark=l):e.variables.push({code:t,name:n,remark:l,isScoped:u,elementId:b(e).uid})},A=function(e,t){const n=t.uid;for(let l=e.variables.length-1;l>=0;l-=1)e.variables[l].elementId===n&&e.variables.splice(l,1)},B=function(e,t,n){if(!t)return!1;if(f(e,t)===f(e,n))return!0;for(;n;){if(t.uid===n.uid)return!1;n=f(e,n)}return!0};const K=await g("vue"),_="inject";O=function(){return s(K,_)(Y)},P=function(){return s(K,_)($)}});export{q as __tla,C as a,R as b,I as c,j as d,x as e,p as f,b as g,B as h,y as i,f as j,P as k,A as l,F as m,T as n,L as p,N as r,O as u};
