import{b as P,a as e}from"./federation-shared-1482b2fe.js";import{S as C,__tla as Q}from"./Scoped-92d0b990.js";let _,U=Promise.all([(()=>{try{return Q}catch{}})()]).then(async()=>{let $,b,r,n,E,N,O,V,z,M,k,B,X;$=await P("@rdx/shared"),b=await P("@lowcode-fe/designer/common"),r=await P("vue"),n="createVNode",E="mergeProps",N="useExprValue",O="useSlot",V="useStore",z="GraphicContainer",M="defineComponent",k="computed",B="useCoordinateLogic",X="isNumber",_=e(r,M)({props:{meta:{type:Object,required:!0}},setup(l,{attrs:i}){const{Slot:p}=e(b,O)(),{coordinateRef:c,rootRef:w}=e($,B)({xAxis:{get min(){return l.meta.xMin},get max(){return l.meta.xMax??1920}},yAxis:{get min(){return l.meta.yMin},get max(){return l.meta.yMax??1080}}});return()=>{const o=c.value,R=(o==null?void 0:o.coordX(0))||0,S=(o==null?void 0:o.coordY(0))||0,t=((o==null?void 0:o.coordX(l.meta.bgLeft))||0)-R,s=((o==null?void 0:o.coordY(l.meta.bgTop))||0)-S,A=((o==null?void 0:o.coordX(l.meta.bgRight))||0)-R,q=((o==null?void 0:o.coordY(l.meta.bgBottom))||0)-S;return e(r,n)(p,null,{default:({children:Y,placeholder:L})=>e(r,n)("div",e(r,E)({ref:w,class:"un-relative",style:{background:l.meta.bgImage?`url(${l.meta.bgImage}) ${t}px ${s}px / calc(100% - ${t}px - ${A}px) calc(100% - ${s}px - ${q}px) no-repeat`:void 0}},i),[o?Y.length?e(r,n)(F,{meta:l.meta,children:Y,coordinate:o},null):L:null])})}}});function T(l){const i={},p=[];return l.forEach(c=>{c.variableKey?i[c.variableKey]?i[c.variableKey].push(c):i[c.variableKey]=[c]:p.push(c)}),{group:i,keys:Object.keys(i),unGroup:p}}const F=e(r,M)({props:{meta:{type:Object,required:!0},children:{type:Array,required:!0},coordinate:{type:Object,required:!0}},setup(l){const{SlotItem:i}=e(b,O)(),p=e(b,V)(),c=e(r,k)(()=>{var t;return T(((t=l.meta.elements)==null?void 0:t.filter(s=>s.type==="line"))??[])}),w=e(r,k)(()=>{var t;return T(((t=l.meta.elements)==null?void 0:t.filter(s=>s.type==="rect"||s.type==="point"))??[])}),o=e(r,k)(()=>l.children.filter(t=>t.metaCode==="slot")),R=e(r,k)(()=>l.children.filter(t=>t.metaCode!=="slot")),S=e(r,k)(()=>({initOpts:{devicePixelRatio:l.meta.dpr,renderer:l.meta.renderer}}));return()=>{const t=l.coordinate,s=l.meta.scopeKey||"canvas",{group:A,keys:q,unGroup:Y}=c.value,{group:L,keys:H,unGroup:J}=w.value;return e(r,n)(C,{scopeKey:`${s}Coord`,data:t},{default:()=>[q.length||Y.length?e(r,n)(e($,z),{class:"un-absolute un-inset-0",coordinate:t,zrenderLogicOpts:S.value},{default:()=>[q.map(a=>{var m,f,I;const y=A[a],h=(m=y.find(g=>{var d;return!!((d=o.value[g.slotIndex].children)!=null&&d.length)}))==null?void 0:m.slotIndex;if(!e($,X)(h))return null;const u=o.value[h];return u?(I=(f=e($,X)(p[a])?Array.from({length:p[a]}):p[a])==null?void 0:f.map)==null?void 0:I.call(f,(g,d)=>{const x=y[d];if(!x)return null;const K=y[d].points.map(G=>t.coord(G).map(v=>Math.floor(v)+.5));return e(r,n)(C,{key:`${x.uid}-${d}`,scopeKey:`${s}Graphic`,data:{points:K,data:g}},{default:()=>[e(r,n)(D,{element:u,key:u.uid},null)]})}):null}),Y.map(a=>{const y=a.points.map(u=>t.coord(u).map(m=>Math.floor(m)+.5)),h=o.value[a.slotIndex];return e(r,n)(C,{key:a.uid,scopeKey:`${s}Graphic`,data:{points:y}},{default:()=>[e(r,n)(D,{element:h,key:h.uid},null)]})})]}):null,H.map(a=>{var m,f,I;const y=L[a],h=(m=y.find(g=>{var d;return!!((d=o.value[g.slotIndex].children)!=null&&d.length)}))==null?void 0:m.slotIndex;if(!e($,X)(h))return null;const u=o.value[h];return u?(I=(f=e($,X)(p[a])?Array.from({length:p[a]}):p[a])==null?void 0:f.map)==null?void 0:I.call(f,(g,d)=>{const x=y[d];if(!x)return null;if(x.type==="rect"){let{x:K,y:G,width:v,height:j}=x;return v<0&&(v=-v,K=K-v),j<0&&(j=-j,G=G-j),e(r,n)(C,{key:`${x.uid}-${d}`,scopeKey:`${s}Graphic`,data:{data:g,index:d}},{default:()=>[e(r,n)(i,{element:u,style:{position:"absolute",left:`${t.coordX(K)}px`,top:`${t.coordY(G)}px`,width:`${t.coordX(v)-t.coordX(0)}px`,height:`${t.coordY(j)-t.coordY(0)}px`,overflow:"hidden"}},null)]})}return e(r,n)(C,{key:`${x.uid}-${d}`,scopeKey:`${s}Graphic`,data:{data:g,index:d}},{default:()=>[e(r,n)(i,{element:u,style:{position:"absolute",left:`${~~t.coordX(x.location[0])+.5}px`,top:`${~~t.coordY(x.location[1])+.5}px`,width:"0px",height:"0px",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},null)]})}):null}),J.map(a=>{if(a.type==="rect"){let{x:y,y:h,width:u,height:m}=a;return u<0&&(u=-u,y=y-u),m<0&&(m=-m,h=h-m),e(r,n)(i,{key:a.uid,element:o.value[a.slotIndex],style:{position:"absolute",left:`${t.coordX(y)}px`,top:`${t.coordY(h)}px`,width:`${t.coordX(u)-t.coordX(0)}px`,height:`${t.coordY(m)-t.coordY(0)}px`,overflow:"hidden"}},null)}return e(r,n)(i,{key:a.uid,element:o.value[a.slotIndex],style:{position:"absolute",left:`${~~t.coordX(a.location[0])+.5}px`,top:`${~~t.coordY(a.location[1])+.5}px`,width:"0px",height:"0px",display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}},null)}),R.value.map(a=>e(r,n)(i,{key:a.uid,element:a},null))]})}}}),D=e(r,M)({props:{element:{type:Object,required:!0}},setup(l){const{SlotItem:i}=e(b,O)(),p=e(b,N)(()=>l.element.isRender);return()=>{var c;return p.value!==!1?(c=l.element.children)==null?void 0:c.map(w=>e(r,n)(i,{element:w,key:w.uid},null)):null}}})});export{_ as Canvas,U as __tla};
